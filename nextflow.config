params {
    // For phidra
    phidra_dir = "/mnt/VEIL/users/nolanv/pipeline_project/VasilVEILPipeline/phidra"
    input_fasta = "/mnt/VEIL/users/nolanv/pipeline_project/VasilVEILPipeline/Short_ENA_test.pep"
    pfamDB = "/mnt/VEIL/users/nolanv/pipeline_project/VasilVEILPipeline/phidra/pfam_database"
    proteins = [
    // [ protein: "RNR", 
    //   pfamDomain: "/mnt/VEIL/users/nolanv/pipeline_project/VasilVEILPipeline/rnr_classIalpha_classII_PF00317_PF02867_PF08343_PF21995_ida_file.tsv", 
    //   subjectDB: "/mnt/VEIL/references/pasv/mmseqs_search/NrdAEJ_alldb_08_27_2018.clean_headers.faa",
    //   pasv_align_refs: "/mnt/VEIL/references/pasv/pasv_profile/rnr__classIa_classII__best_practices.fa"], // smaller database, pasv needs smaller alignment and phidra needs larger db
      
    [ protein: "PolE", 
      pfamDomain: "/mnt/VEIL/users/nolanv/pipeline_project/VasilVEILPipeline/pola_PF00476_ida_file.tsv", 
      // subjectDB: "/mnt/VEIL/users/nolanv/pipeline_project/VasilVEILPipeline/uniprotkb_DNA_polymerase_A_plus_BATS_his.fasta",
      subjectDB: "/mnt/VEIL/users/nolanv/pipeline_project/VasilVEILPipeline/pola_short.fasta",
      pasv_align_refs: "/mnt/VEIL/references/pasv/pasv_profile/pola_16_k12_ref.fa"], // larger database, correct for phidra

        [ protein: "PolA", 
      pfamDomain: "/mnt/VEIL/users/nolanv/pipeline_project/VasilVEILPipeline/pola_PF00476_ida_file.tsv", 
      // subjectDB: "/mnt/VEIL/users/nolanv/pipeline_project/VasilVEILPipeline/uniprotkb_DNA_polymerase_A_plus_BATS_his.fasta",
      subjectDB: "/mnt/VEIL/users/nolanv/pipeline_project/VasilVEILPipeline/pola_short.fasta",
      pasv_align_refs: "/mnt/VEIL/references/pasv/pasv_profile/pola_16_k12_ref.fa"], // larger database, correct for phidra

    // [ protein: "Helicase",
    //   pfamDomain: "/mnt/VEIL/tools/phidra_resources/ida_files/helicase_ida_file.tsv", 
    //   subjectDB: "/mnt/VEIL/users/nolanv/pipeline_project/VasilVEILPipeline/helicase_short.fasta",
    // ],
    
    [ protein: "PolB",
      pfamDomain: "/mnt/VEIL/tools/phidra_resources/ida_files/polb_PF08490_PR00136_PF03175_ida_file.tsv", 
      // subjectDB: "/mnt/VEIL/tools/phidra_resources/subject_db/polb_refs_pPolB_rPolB_piPolB.fasta"
      subjectDB: "/mnt/VEIL/users/nolanv/pipeline_project/VasilVEILPipeline/polb_short.fasta",
    ]
] 

// mmseqs_search is for phidra. pasv_profile is for pasv
// /mnt/VEIL/references/pasv/pasv_profile/rnr__classIa_classII__best_practices.fa
// /mnt/VEIL/references/pasv/pasv_profile/pola_16_k12_ref.fa
// pasv_align_refs

// /mnt/VEIL/users/nolanv/pipeline_project/VasilVEILPipeline/uniprotkb_DNA_polymerase_A_plus_BATS_his.fasta for subjectDB
// /mnt/VEIL/references/pasv/mmseqs_search/NrdAEJ_alldb_08_27_2018.clean_headers.faa for subject DB


// pasv post processing instead of only looking for RDK signature, want to look for anythign that does not have gaps in the position we look at and print statistics
// parse through putative.pasvsignatures.tsv files and get tally of signatures that do not have any gaps in them. and what that spans value is.
// create some multipanel boxplots with the start, end, have both, and neither. break it out by signature (RDKF, TDKF etc.)
// boxplot of length of ORF, each instrance would be a point, probably want to label at the bottom signature

// new post processing is check that signature column has no gaps
// group by signature and spans
// tally of above combinations
// plot a boxplot of signature (x axis) vs length (y axis which is parsed from name column naming convention)
// have these in panels based on spans column
// label this with the tally

  outdir = "/mnt/VEIL/users/nolanv/pipeline_project/VasilVEILPipeline/output_test/"

  second_run = "/mnt/VEIL/users/nolanv/pipeline_project/VasilVEILPipeline/output_test/combined_results.tsv"
  selected_genofeatures = ['RDKY','RDKF','RDKL','pPolB','rPolB']
  genofeature_metadata = "/mnt/VEIL/users/nolanv/embedding_test/protein_metadata_all.txt"
}

process {
    withLabel: 'gpu' {
        executor = 'slurm'
        queue = 'gpu2'
        clusterOptions = '--gres=gpu:1 --partition=gpu2 --account=gpu2 --qos=gpu'
    }
}